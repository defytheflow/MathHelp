{% extends 'base.html' %}

{% load static %}

{% block title %} {{ user.profile.first_name }} {{ user.profile.last_name }} {% endblock %}

{% block css %}
  <link rel="stylesheet" href="{% static 'profiles/css/profiles.css' %}">
{% endblock %}



{% block content %}

  <div class="container">
    <table class="profile-info">
      <tr>
        <td class="user-info">
          <div>
            <img src="{{ user.profile.photo.url }}" width="200px" height="200px">
          <b>{{ user.profile.first_name }} {{ user.profile.last_name }}</b>
          <a class="btn btn-blue" href="{% url PROFILE_UPDATE_URL user.username %}">
            Редактировать
          </a>
          </div>
        </td>

        <td class="user-stat">
          <div class='greeting'>
            <h3 id="greeting">{{ user.profile.first_name }}</h3>
          </div>
              {% if request.session.read_tickets %}

              <div class="heading">
                <h3>Сегодня ты
                  {% if user.profile.is_male %}
                    читал
                  {% elif user.profile.is_female %}
                    читала
                  {% endif %}
                эти билеты:</h3>
              </div>

              {% for ticket in read_tickets %}
              <div class="border-bottom">
                <p class="body-font"><a href="{{ ticket.get_absolute_url }}">{{ ticket.name }}</a></p>
              </div>
              {% endfor %}

              {% endif %}

            {% if taken_quizzes %}
            <div class="heading">
              <h3>Результаты по тестам за сегодня:</h3>
            </div>
            <table class="today-results">
              <tr>
                <th><p class="body-font">Название</p></th>
                <th><p class="body-font">Результат</p></th>
                <th><p class="body-font">Сохранен</p></th>
              </tr>
                {% for quiz in taken_quizzes %}
              <tr>
                <td class="border-bottom"><p class="body-font"><a href="{{ quiz.get_absolute_url }}">{{ quiz.ticket.name }}</a></p></td>
                <td class="border-bottom"><p class="body-font">{{ quiz.result }}%</p></td>
                <td class="border-bottom">
                  {% if quiz.saved %}
                  <img src="{% static 'profiles/img/check.png' %}" width="20" height="20">
                  {% else %}
                  <img src="{% static 'profiles/img/cross.png' %}" width="20" height="20">
                  {% endif %}
                </td>
              </tr>
                {% endfor %}
              </table>
            {% endif %}



         <div class="heading">
          <h3>Результаты за все время</h3>
         </div>

          <table class="all-results">
            <tr>
              <th>Тест</th>
              <th>Результат</th>
            </tr>
            {% for result in results %}
            <tr>
              <td class="border-bottom"><p class="body-font">{{ result.quiz.ticket.name }}</p></td>
              <td class="border-bottom"><p class="body-font">{{ result.percent }}%</p></td>
            </tr>
            {% endfor %}
          </table>

        </td>
      </tr>
    </table>
  </div>
{% endblock %}

{% block js %}
    <script src="{% static 'profiles/js/profiles.js' %}"></script>
{% endblock %}
